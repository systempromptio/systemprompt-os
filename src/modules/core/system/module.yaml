name: system
type: daemon
version: 1.0.0
description: Core system management with health monitoring, metrics, and maintenance
author: systemprompt-os
dependencies:
  - logger
  - database
config:
  monitoring:
    enabled: true
    interval: 60000  # 1 minute
    metricsFile: ${METRICS_FILE:-./state/system-metrics.json}
  health:
    checks:
      - memory
      - cpu
      - disk
      - modules
    thresholds:
      memory: 0.9    # 90% memory usage warning
      cpu: 0.8       # 80% CPU usage warning
      disk: 0.85     # 85% disk usage warning
  backup:
    enabled: false
    path: ${BACKUP_PATH:-./backups}
    retention: 7   # days
cli:
  commands:
    - name: status
      description: Show comprehensive system status (memory, CPU, uptime, versions)
      options:
        - name: format
          alias: f
          type: string
          description: Output format (json, yaml, table)
          default: table
          choices: [json, yaml, table]
        - name: detailed
          alias: d
          type: boolean
          description: Show detailed status information
    - name: health
      description: Run full system health check with diagnostics
      options:
        - name: fix
          type: boolean
          description: Attempt to fix issues automatically
        - name: report
          alias: r
          type: string
          description: Save health report to file
    - name: restart
      description: Gracefully restart the system
      options:
        - name: force
          alias: f
          type: boolean
          description: Force restart without graceful shutdown
        - name: confirm
          type: boolean
          description: Skip confirmation prompt
          default: false
    - name: backup
      description: Create system backup (config, data, modules)
      options:
        - name: include
          alias: i
          type: string
          description: Components to include (all, config, data, modules)
          default: all
        - name: compress
          alias: c
          type: boolean
          description: Compress backup
          default: true
    - name: update
      description: Git pull to update core code
      options:
        - name: branch
          alias: b
          type: string
          description: Git branch to pull from
        - name: restart
          type: boolean
          description: Restart system after update
    - name: restore
      description: Restore from backup
      options:
        - name: file
          alias: f
          type: string
          description: Backup file to restore from
          required: true
        - name: components
          type: string
          description: Components to restore (all, config, data, modules)
          default: all
    - name: logs
      description: View and manage system logs
      options:
        - name: level
          alias: l
          type: string
          description: Log level filter
          choices: [debug, info, warn, error]
        - name: module
          alias: m
          type: string
          description: Filter by module name
        - name: tail
          alias: t
          type: number
          description: Number of lines to show
          default: 100
        - name: follow
          alias: f
          type: boolean
          description: Follow log output
    - name: metrics
      description: View system performance metrics
      options:
        - name: period
          alias: p
          type: string
          description: Time period (1h, 24h, 7d, 30d)
          default: 1h
        - name: type
          alias: t
          type: string
          description: Metric type (cpu, memory, disk, all)
          default: all
    - name: events
      description: View system event stream
      options:
        - name: type
          alias: t
          type: string
          description: Event type filter
        - name: since
          alias: s
          type: string
          description: Show events since timestamp
apis:
  - name: getSystemStatus
    description: Get current system status
  - name: getHealthReport
    description: Get comprehensive health report
  - name: getMetrics
    description: Get system metrics for period
  - name: createBackup
    description: Create system backup
  - name: restoreBackup
    description: Restore from backup
  - name: getEvents
    description: Get system events
singleton: true
enabled: true